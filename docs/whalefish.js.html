<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: whalefish.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: whalefish.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

// Require dependencies
const http = require('http');
const { parse } = require('url');
const { resolve } = require('path');
const minimatch = require('minimatch');

const Response = require('./response');

const routes = []; // List of routes

/**
 * Whalefish class
 */

class Whalefish {

  /**
    * Whalefish routing
    * @param {String} path - Route path
    * @param {Function(req:object, res:object):void} callback - Route callback
    * @param {Int} [statusCode] - Status code to return for the route
    * @returns {this}
    */

  route(path, callback, statusCode = 200) {
    routes.push([resolve(parse(path).pathname), callback, statusCode]); // Add route to list of routes

    return this;
  }

  /**
   * Serve the application on a port
   * @param {Int} port - Port to serve on
   * @param {Function(request:object, response:object, status:int)} callback - Callback
   * @returns {this}
   */

  serve(port, callback) {
    let request;
    let response;

    let status = 200;

    /**
     * Send a file to be displayed to the client
     * @param {String} filePath
     * @param {String} [mimeType]
     * @param {Boolean} [displayInline]
     */

    http.createServer((req, res) => {
      // res and req should be accessible outside this callback
      request = req;
      response = res;

      for (let i = 0; i &lt; routes.length; i++) {
        if (minimatch(resolve(parse(req.url).pathname), routes[i][0])) {
          status = routes[i][2];
          routes[i][1](request, new Response(response, status));
          break;
        }
      }
    }).listen(port, () => callback(request, new Response(response, status)));

    return this;
  }
}

module.exports = exports = Whalefish;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Response.html">Response</a></li><li><a href="Whalefish.html">Whalefish</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Wed Jan 27 2021 20:58:22 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
